<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PAINS - 부원 소개</title>
    <style>
        /* ============================ */
        /* [1] 폰트 파일 불러오기 설정 */
        /* ============================ */
        @font-face {
            font-family: 'KBO_Dia';
            src: url('KBO_medium.woff') format('woff');
            font-weight: normal; font-style: normal;
        }
        @font-face {
            font-family: 'SCDream';
            src: url('SCDream5.otf');
            font-weight: normal; font-style: normal;
        }

        /* ============================ */
        /* [2] 기본 스타일 및 폰트 적용 */
        /* ============================ */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: 'SCDream', sans-serif; 
            line-height: 1.6; 
            color: #333; 
            background-color: #fdfdfd; 
        }
        
        header h1, section h2 {
            font-family: 'KBO_Dia', sans-serif;
        }

        /* ============================ */
        /* [3] 레이아웃 스타일          */
        /* ============================ */
        header { background-color: #cf8b8b; color: white; padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; }
        header h1 { font-size: 1.5rem; font-weight: bold; }
        
        nav { display: flex; align-items: center; }
        nav a { color: #ecf0f1; text-decoration: none; margin-left: 15px; font-size: 0.9rem; transition: color 0.3s; }
        nav a:hover { color: #fff; font-weight: bold; }

        section { padding: 3rem 1rem; max-width: 1200px; margin: 0 auto; }
        h2 { font-size: 2rem; color: #ab3333; margin-bottom: 40px; text-align: center;}
        footer { background-color: #333; color: white; text-align: center; padding: 2rem; margin-top: 2rem; font-size: 0.8rem; }

        /* ==================== */
        /* [4] 조직도 스타일    */
        /* ==================== */
        .org-chart-wrapper {
            overflow-x: auto; padding: 20px 0; text-align: center; -webkit-overflow-scrolling: touch; 
        }
        .tree-container {
            display: inline-block; position: relative; padding-top: 20px; min-width: 700px; 
        }

        /* 카드 디자인 */
        .org-card {
            background: white; border: 2px solid #ab3333; border-radius: 12px; padding: 15px;
            text-align: center; width: 160px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            position: relative; z-index: 2; margin: 0 auto; /* 중앙 정렬 보정 */
        }
        
        .org-img {
            width: 80px; height: 80px; background-color: #eee; border-radius: 50%;
            margin: 0 auto 10px; background-size: cover; background-position: center;
        }
        
        .org-role { color: #ab3333; font-weight: bold; font-size: 0.9rem; margin-bottom: 4px; }
        .org-name { font-size: 1.1rem; font-weight: bold; margin-bottom: 4px; }
        .org-major { font-size: 0.8rem; color: #666; word-break: keep-all; }

        /* 레벨 배치 */
        .level-1, .level-2, .level-3 {
            display: flex; justify-content: center; position: relative;
        }
        .level-1 { margin-bottom: 50px; }
        .level-2 { margin-bottom: 50px; }
        .level-3 { gap: 40px; }

        /* 연결선 스타일 */
        .line { position: absolute; background-color: #ccc; z-index: 1; }
        .line-v-1 { width: 2px; height: 50px; top: 100%; left: 50%; transform: translateX(-50%); }
        
        .vice-president-wrapper { position: relative; display: flex; justify-content: center; }
        .line-v-2-short { width: 2px; height: 25px; top: 100%; left: 50%; transform: translateX(-50%); }
        .line-h-long { height: 2px; width: 400px; top: calc(100% + 25px); left: 50%; transform: translateX(-50%); }
        
        /* 3갈래 줄기 (3명일 때 최적화) */
        .line-v-3-branches { width: 2px; height: 25px; top: calc(100% + 25px); }
        .branch-left { left: calc(50% - 200px); }
        .branch-center { left: 50%; transform: translateX(-50%); }
        .branch-right { right: calc(50% - 200px); }

        /* 총무 위치 (절대 위치) */
        .general-affairs-wrapper { position: absolute; left: calc(50% + 140px); top: 0; }
        .card-staff { border-color: #7f8c8d; }
        .card-staff .org-role { color: #7f8c8d; }

        @media (max-width: 600px) {
            header { flex-direction: column; gap: 10px; }
            section { padding: 2rem 0; }
        }
    </style>
</head>
<body>

    <header>
        <h1>PAINS Members</h1>
        <nav>
            <a href="index.html">Home</a>
        </nav>
    </header>

    <section>
        <h2>10기 운영진 조직도</h2>

        <div class="org-chart-wrapper">
            <div class="tree-container">
                
                <div class="level-1">
                    <div style="position: relative;">
                        <div class="org-card" id="card-president">
                            <div class="org-img"></div> 
                            <div class="org-role">회장</div>
                            <div class="org-name">Loading...</div>
                            <div class="org-major">-</div>
                        </div>
                        <div class="line line-v-1"></div>
                    </div>

                    <div class="general-affairs-wrapper">
                        <div class="org-card card-staff" id="card-staff">
                            <div class="org-img"></div>
                            <div class="org-role">총무</div>
                            <div class="org-name">Loading...</div>
                            <div class="org-major">-</div>
                        </div>
                    </div>
                </div>

                <div class="level-2">
                    <div class="vice-president-wrapper">
                        <div class="org-card" id="card-vice">
                            <div class="org-img"></div>
                            <div class="org-role">부회장</div>
                            <div class="org-name">Loading...</div>
                            <div class="org-major">-</div>
                        </div>
                        <div class="line line-v-2-short"></div>
                        <div class="line line-h-long"></div>
                        <div class="line line-v-3-branches branch-left"></div>
                        <div class="line line-v-3-branches branch-center"></div>
                        <div class="line line-v-3-branches branch-right"></div>
                    </div>
                </div>

                <div class="level-3" id="container-managers">
                    <div class="org-name">데이터를 불러오는 중...</div>
                </div>

            </div>
        </div>
    </section>

    <footer>
        <p>&copy; 2026 PAINS. All rights reserved.</p>
    </footer>

    <script>
        // 제공해주신 CSV 링크
        const MEMBERS_SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRBnuUvyE2CDV-hG26xCVdnt88JhQgtusdEndJwTzaI62TXPdWTNldVvua9RLkXj1s34qiM0CEcNvbr/pub?gid=346060998&single=true&output=csv";

        async function fetchAndRenderMembers() {
            try {
                const response = await fetch(MEMBERS_SHEET_URL);
                const data = await response.text();
                
                // CSV 파싱
                const rows = data.split("\n").map(row => row.trim()).filter(row => row.length > 0);
                
                // 첫 줄(헤더) 제거 후 객체로 변환
                const members = rows.slice(1).map(row => {
                    const cols = row.split(",");
                    if (cols.length < 4) return null;
                    return {
                        level: cols[0].trim(),   // A열
                        role: cols[1].trim(),    // B열
                        name: cols[2].trim(),    // C열
                        major: cols[3].trim(),   // D열
                        image: cols[4] ? cols[4].trim() : "" // E열 (이미지 없으면 빈칸)
                    };
                }).filter(m => m !== null);

                renderOrgChart(members);

            } catch (error) {
                console.error("데이터 로딩 실패:", error);
                document.getElementById('container-managers').innerHTML = "<div>데이터를 불러오지 못했습니다.</div>";
            }
        }

        function renderOrgChart(members) {
            // 1. 주요 직책 채우기 (회장, 총무, 부회장)
            // find 함수를 써서 '직책(Role)' 이름으로 찾습니다.
            const president = members.find(m => m.role === '회장');
            const staff = members.find(m => m.role === '총무');
            const vice = members.find(m => m.role === '부회장');

            // 카드 업데이트 함수 호출
            if (president) updateCard('card-president', president);
            if (staff) updateCard('card-staff', staff);
            if (vice) updateCard('card-vice', vice);

            // 2. 부장단 (Level 3) 채우기
            const managers = members.filter(m => m.level === '3');
            const managerContainer = document.getElementById('container-managers');
            managerContainer.innerHTML = ""; // 기존 내용(로딩중) 지우기

            managers.forEach(mgr => {
                const cardHTML = `
                    <div class="org-card">
                        <div class="org-img" style="${mgr.image ? `background-image: url('${mgr.image}');` : ''}"></div>
                        <div class="org-role">${mgr.role}</div>
                        <div class="org-name">${mgr.name}</div>
                        <div class="org-major">${mgr.major}</div>
                    </div>
                `;
                managerContainer.insertAdjacentHTML('beforeend', cardHTML);
            });
        }

        // 개별 카드 내용을 바꾸는 도우미 함수
        function updateCard(elementId, data) {
            const card = document.getElementById(elementId);
            if(!card) return;

            // 이미지 처리
            const imgDiv = card.querySelector('.org-img');
            if (data.image) {
                imgDiv.style.backgroundImage = `url('${data.image}')`;
            }

            // 텍스트 처리
            card.querySelector('.org-role').innerText = data.role;
            card.querySelector('.org-name').innerText = data.name;
            card.querySelector('.org-major').innerText = data.major;
        }

        // 실행
        fetchAndRenderMembers();
    </script>

</body>
</html>
